"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}Object.defineProperty(exports,"__esModule",{value:!0}),require("./lib/promise-polyfill");var eventList={},oldMessage={},caller=function(e,t){return Promise.resolve().then(function(){var r,n;return(r=e.context,n=e.callback).call.apply(n,[r].concat(_toConsumableArray(t)))})},on=function(e,t,r,n,s){e in eventList||(eventList[e]={}),t in eventList[e]||(eventList[e][t]=[]),eventList[e][t].push({callback:r,context:n}),s&&e in oldMessage&&oldMessage[e].forEach(function(e){(t===e.route||"*"===t)&&r.call.apply(r,[n].concat(_toConsumableArray(e.args)))})},off=function(e,t,r){if(2===arguments.length&&(r=t,t="*"),e in eventList&&t in eventList[e])for(var n=eventList[e][t],s=n.length-1;s>=0;s--)n[s].callback===r&&n.splice(s,1)},trigger=function(e,t){for(var r=arguments.length,n=Array(r>2?r-2:0),s=2;r>s;s++)n[s-2]=arguments[s];var o=[];if(e in eventList){var l=eventList[e];Object.keys(l).forEach(function(e){(t===e||"*"===t||"*"===e)&&l[e].forEach(function(e){return o.push(caller(e,n))})})}var a=Promise.all(o);return{save:function(){return e in oldMessage||(oldMessage[e]=[]),oldMessage[e].push({route:t,args:n}),{results:a}},results:a}},_deleteAllEvents=function(){eventList={},oldMessage={}},shouter={on:on,off:off,trigger:trigger,_deleteAllEvents:_deleteAllEvents};exports.shouter=shouter,exports.on=on,exports.off=off,exports.trigger=trigger,exports["default"]=shouter;
//# sourceMappingURL=shouter.js.map