"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}Object.defineProperty(exports,"__esModule",{value:!0}),require("promise-polyfill");var eventList={},oldMessage={},caller=function(e,t){return new Promise(function(r,n){setTimeout(function(){var o=void 0;try{var s,a;o=(s=e.context,a=e.callback).call.apply(a,[s].concat(_toConsumableArray(t))),r(o)}catch(l){n(l)}})})},on=function(e,t,r,n,o){e in eventList||(eventList[e]={}),t in eventList[e]||(eventList[e][t]=[]),eventList[e][t].push({callback:r,context:n}),o&&e in oldMessage&&oldMessage[e].forEach(function(e){(t===e.route||"*"===t)&&r.call.apply(r,[n].concat(_toConsumableArray(e.args)))})},off=function(e,t,r){if(2===arguments.length&&(r=t,t="*"),e in eventList&&t in eventList[e])for(var n=eventList[e][t],o=n.length-1;o>=0;o--)n[o].callback===r&&n.splice(o,1)},trigger=function(e,t){for(var r=arguments.length,n=Array(r>2?r-2:0),o=2;r>o;o++)n[o-2]=arguments[o];var s=[];if(e in eventList){var a=eventList[e];Object.keys(a).forEach(function(e){(t===e||"*"===t||"*"===e)&&a[e].forEach(function(e){return s.push(caller(e,n))})})}var l=Promise.all(s);return{save:function(){return e in oldMessage||(oldMessage[e]=[]),oldMessage[e].push({route:t,args:n}),{results:l}},results:l}},_deleteAllEvents=function(){eventList={},oldMessage={}},shouter={on:on,off:off,trigger:trigger,_deleteAllEvents:_deleteAllEvents};exports.shouter=shouter,exports.on=on,exports.off=off,exports.trigger=trigger,exports["default"]=shouter;
//# sourceMappingURL=shouter.js.map